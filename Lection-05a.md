# Доп. лекция

## Содержание
* [Управление доступом к сетевой среде](https://github.com/AliakseiSuvorau/networks/blob/master/Lection-05a.md#управление-доступом-к-сетевой-среде)
  * Механизмы аутентификации
  * Алгоритм аутентификации
  * Возможные конфигурации
  * ААА-сервера
  * Протоколы для общения между NAS- и ААА-серверами

## Управление доступом к сетевой среде

### Механизмы аутентификации

* Позволяют принять решение, пускать ли в сеть трафик от клиента
* Стандартный механизм описан в стандарте IEEE 802.1X-2020
* Аутентификация по mac-адресу

> [!CAUTION]
> mac-адрес можно подделать, поэтому такая аутентификация не безопаская

* **Идея**: запрашивать ввод логина и пароля при входе в сеть
  * *Проблема масштабируемости*: у коммутатора должен быть доступ к некой базе данных. А если коммутаторов несколько, то придется для каждого эту базу дублировать, либо придумывать еще что-то
  * *Решение*: Вынести авторизацию в отдельный сетевой сервис, с которым коммутатор будет общаться посредством специального протокола для того, чтобы понять, впускать ли клиента

### Алгоритм аутентификации

* Кандидат(клиент, желающий подключиться к сети) присылает пакет EAPOL-Start

> [!NOTE]
> Этот шаг опциональный: кандидат может не присылать этот пакет, а коммутатор будет запрашивать авторизацию с первой информацией от клиента

* Аутентификатор (в нашем случае - коммутатор) посылает пакет EAP-Request/Identity кандидату
* Кандидат посылает пакет EAP-Response/Identity. Это пакет канального уровня. Коммутатор переделывает этот пакет в пакет прикладного уровня (см. RADIUS) и отправляет его серверу аутентификации
* Сервер, выбрав алгоритм аутентификации, посылает обратно пакет EAP-Request. Коммутатор снова переделывает пакет с прикладного уровня на канальный и посылает кандидату
* Кандидат формирует пакет-ответ EAP-Response
* Пакет пересылается на сервер. Далее сервер либо дает доступ (EAP-Success), либо отказывает в доступе (EAP-Reject)

> [!NOTE]
> Опционально сервер может также отправить некоторые сетевые настройки, к примеру - членство в VLAN

* В случае успеха порт открывается для любого трафика
  * Пока с ним ассоциируется mac-адрес клиента (piggybacking)
  * Только для mac-адреса клиента

* В завершение сеанса клиент посылает пакет EAPOL-Logoff. После этого порт снова будет игнорировать трафик до следующей успешной авторизации

### Возможные конфигурации

* Соискатель - конечная система
  * Один аутентификатор - один соискатель (*рекомендовано*)
  * Один аутентификатор - много соискателей (проблемы с безопасностью)
* Соискатель - коммуникационное устройство
  * Один аутентификатор - один соискатель (*рекомендовано*)
  * Один аутентификатор - много соискателей (проблемы с безопасностью)
  * Взаимная аутентификация (*рекомендовано*)

### ААА-сервера

* Authentication
* Authorization
* Accounting

### Протоколы для общения между NAS- и ААА-серверами

* RADIUS - Remote Authentication Dial In User Service
* NAS-сервер - устройство, через которое клиент входит сеть (в нашем случае - коммутатор)

| Код | Тип сообщения       |
|-----|---------------------|
| 1   | Access-Request      |
| 2   | Access-Accept       |
| 3   | Access-Reject       |
| 4   | Accounting-Request  |
| 5   | Accounting-Response |
| 11  | Access-Challenge    |

> [!NOTE]
> Accounting-Request и Accounting-Response используются для сообщения о событиях в сети, к примеру - подключения нового пользователя


> [!NOTE]
> Наиболее попрулярный протокол - RADIUS, но также используются Diameter и TACACS
